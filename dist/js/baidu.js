function init(){window.clearTimeout(mapTimeout),map=new BMap.Map("map"),initMarker(BMap.Marker.prototype),convert(new BMap.Point(120.11222183704376,30.284863403785405),function(e){map.centerAndZoom(e.points[0],16),map.addControl(new BMap.MapTypeControl),map.setCurrentCity("杭州"),map.enableScrollWheelZoom(!0),loadData(model.items)}),model.infoWindow=new BMap.InfoWindow}function convert(e,o){var n=new BMap.Convertor,i=[];i.push(e),n.translate(i,3,5,o)}function initMarker(e){e.setLarge=function(){this.selected=!0,this.setAnimation(BMAP_ANIMATION_BOUNCE)},e.setNormal=function(){this.selected=!1,this.setAnimation(null)},e.setSelect=function(){console.log(this.selected),window.icon=this.getIcon(),this.setAnimation(BMAP_ANIMATION_BOUNCE)},e.openWindow=function(){model.infoWindow.setContent(this.stationInfo),this.openInfoWindow(model.infoWindow),this.open=!0},e.toggleWindow=function(){window.clickDelay||(window.clickDelay=!0,window.setTimeout(function(){if(window.clickDelay=!1,this.open)return this.closeInfoWindow(),void(this.open=!1);this.openWindow()}.bind(this),200))}}function toggleside(){$(".container").toggleClass("side-hide")}function loadData(e){function o(e){if(t.getStatus()==BMAP_STATUS_SUCCESS){n(e);var o=e.getPageIndex()+1;o<e.getNumPages()&&t.gotoPage(o)}}function n(o){for(var n,i=0;i<o.getCurrentNumPois();i++){n=o.getPoi(i);var t=new BMap.Marker(n.point);t.title=n.title,t.visible=!0,t.selected=!1,t.stationInfo=n.address,t.position=n.point,t.open=!1,t.addEventListener("click",t.toggleWindow),e.push(t),map.addOverlay(t)}}map.clearOverlays();var i={pageCapacity:10,onSearchComplete:o},t=new BMap.LocalSearch(map,i);t.searchInBounds("公交站",map.getBounds())}function showList(){$(".sidebar ul").addClass("show")}function hideList(){window.setTimeout(function(){$(".show").toggleClass("show")},100)}function inputChange(e){return window.clearTimeout(window.keypressTimer),window.keypressTimer=window.setTimeout(function(){var o=e.inputval(),n=e.items().map(function(e,n){return e.title.match(o)?(e.visible=!0,e.show()):(e.visible=!1,e.hide()),e});e.items.removeAll(),e.items(n)},500),!0}function gm_authFailure(){model.tips("Google Map无权访问")}var map,model={inputval:ko.observable(),items:ko.observableArray(),infoWindow:void 0,tips:ko.observable("")};ko.applyBindings(model);var mapTimeout=setTimeout(function(){model.tips("地图加载超时")},5e3);